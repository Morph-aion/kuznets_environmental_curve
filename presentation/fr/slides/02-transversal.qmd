# Approche Transversale {background-color="#00796B"}

::: {style="text-align: center; margin-top: 3em;"}
## üì∏ Partie I : Validation spatiale

**159 pays (2020)** | Quelle forme prend l'EKC dans l'espace ?
:::

::: {.notes}
Dur√©e : ~7 minutes. 
Objectif : Montrer que le mod√®le quadratique suffit + h√©t√©rog√©n√©it√© massive.
:::

---

## üåç Donn√©es et contexte empirique

::: {.panel-tabset}

### Vue d'ensemble 2020

```{python}
#| echo: false
#| fig-width: 14
#| fig-height: 6
#| fig-dpi: 300

import matplotlib.pyplot as plt
import numpy as np
from statsmodels.nonparametric.smoothers_lowess import lowess

# S√©lection de pays √† annoter
PAYS_LABELS = {
    'United States': 'USA', 'China': 'CHN', 'India': 'IND', 
    'Qatar': 'QAT', 'France': 'FRA', 'Sweden': 'SWE', 
    'Germany': 'DEU', 'Brazil': 'BRA'
}

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# A. GRAPHIQUE LOG-LOG (Vision √©conom√©trique)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

axes[0].scatter(df_cross['gdp_pc'], df_cross['co2_per_capita'], 
                alpha=0.5, s=60, color='#34495e', edgecolor='white', linewidth=0.5)

axes[0].set_xscale('log')
axes[0].set_yscale('log')
axes[0].set_xlabel("PIB par habitant (USD PPA 2017)", fontsize=12)
axes[0].set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
axes[0].set_title("A. √âchelle Log-Log (Vision √âconom√©trique)", fontweight='bold', fontsize=13)
axes[0].grid(True, which="both", ls="--", alpha=0.3)

# Annotations
for pays, code in PAYS_LABELS.items():
    row = df_cross[df_cross['country'] == pays]
    if not row.empty:
        x = row['gdp_pc'].values[0]
        y = row['co2_per_capita'].values[0]
        axes[0].text(x, y, f" {code}", fontsize=9, fontweight='bold', 
                     color='#2c3e50', va='bottom')

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# B. GRAPHIQUE LOG-LIN (R√©alit√© physique)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

axes[1].scatter(df_cross['gdp_pc'], df_cross['co2_per_capita'], 
                alpha=0.5, s=60, color='#c0392b', edgecolor='white', linewidth=0.5)

# Tendance LOWESS
lowess_result = lowess(df_cross['co2_per_capita'], np.log(df_cross['gdp_pc']), frac=0.3)
axes[1].plot(np.exp(lowess_result[:, 0]), lowess_result[:, 1], 
             color='black', linewidth=2.5, linestyle='--', label='Tendance LOWESS')

axes[1].set_xscale('log')
axes[1].set_xlabel("PIB par habitant (USD PPA 2017)", fontsize=12)
axes[1].set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
axes[1].set_title("B. √âchelle Log-Lin√©aire (R√©alit√© Physique)", fontweight='bold', fontsize=13)
axes[1].legend(loc='upper left', fontsize=10)
axes[1].grid(True, which="both", ls="--", alpha=0.3)

# Annotations
for pays, code in PAYS_LABELS.items():
    row = df_cross[df_cross['country'] == pays]
    if not row.empty:
        x = row['gdp_pc'].values[0]
        y = row['co2_per_capita'].values[0]
        ha = 'right' if y > 30 else 'left'
        axes[1].text(x, y, f"{code} " if ha == 'right' else f" {code}", 
                     fontsize=9, fontweight='bold', 
                     color='#c0392b', va='center', ha=ha)

plt.tight_layout()
plt.show()
```

::: {.columns}
::: {.column width="50%"}
::: {.callout-note appearance="minimal"}
## Panel A : Justification log-log
Relation quasi-**lin√©aire** en √©chelle log  
‚Üí Interpr√©tation en **√©lasticit√©s**
:::
:::

::: {.column width="50%"}
::: {.callout-warning appearance="minimal"}
## Panel B : H√©t√©rog√©n√©it√©
Qatar (35 t) vs Su√®de (4 t) √† PIB √©gal  
‚Üí **Facteur 9** : les politiques comptent
:::
:::
:::

### Trajectoires 1990-2020

```{python}
#| echo: false
#| fig-width: 12
#| fig-height: 6
#| fig-dpi: 300

import matplotlib.pyplot as plt

# Calcul des moyennes par groupe et ann√©e
trajectories = df.groupby(['year', 'income_group'])['co2_per_capita'].mean().reset_index()

# Palette de couleurs
palette = {
    'High income': '#e74c3c',
    'Upper middle income': '#f39c12', 
    'Lower middle income': '#3498db',
    'Low income': '#2ecc71'
}

# Graphique
fig, ax = plt.subplots(figsize=(12, 6))

for group, color in palette.items():
    subset = trajectories[trajectories['income_group'] == group]
    ax.plot(subset['year'], subset['co2_per_capita'], 
            color=color, linewidth=3, label=group, marker='o', markersize=5)

ax.set_xlabel("Ann√©e", fontsize=14)
ax.set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=14)
ax.set_title("√âvolution des √©missions par groupe de revenu (1990-2020)", fontweight='bold', fontsize=15)
ax.legend(loc='upper left', fontsize=12)
ax.grid(True, alpha=0.3)
ax.axhline(y=0, color='black', linewidth=0.8, linestyle='-')

plt.tight_layout()
plt.show()
```

::: {.callout-note appearance="minimal"}
## Trois clubs divergents
üî¥ **Pays riches** : Pic ~2005, d√©clin -30%  
üü† **√âmergents** : Croissance exponentielle +150%  
üîµ **Pays pauvres** : Stagnation ~1 t/hab

‚Üí L'EKC ne d√©crit **pas** une loi universelle
:::

### Donn√©es mobilis√©es

::: {.columns}
::: {.column width="50%"}
**Source**

- Our World in Data (2020)
- Global Carbon Project
- Banque Mondiale

**√âchantillon**

- **159 pays** (>95% PIB mondial)
- P√©riode : **1990-2020** (30 ans)
- ~4770 observations
:::

::: {.column width="50%"}
**Variables cl√©s**

| Variable | Unit√© | Transformation |
|----------|-------|----------------|
| CO‚ÇÇ/hab | tonnes/an | $\ln(\text{CO}_2)$ |
| PIB/hab | $ PPA 2017 | $\ln(\text{PIB})$ centr√© |

**Exclusions** : 12 micro-√âtats et paradis fiscaux  
(Liechtenstein, Monaco, Luxembourg, Singapour...)

**Justification log** : Test Box-Cox ‚Üí Œª = 0.15 ‚âà 0
:::
:::

:::

::: {.notes}
**Pour l'oral** :

**Onglet 1 (Vue d'ensemble)** :
- Panel A : "En log-log, la relation devient quasi-lin√©aire ‚Üí justifie notre sp√©cification"
- Panel B : "En √©chelle r√©elle, on voit l'h√©t√©rog√©n√©it√© explosive : Qatar vs Su√®de = facteur 9"

**Onglet 2 (Trajectoires)** :
- "Cette h√©t√©rog√©n√©it√© n'est pas statique : 3 clubs √©voluent diff√©remment depuis 30 ans"
- "Pays riches ont D√âJ√Ä d√©coupl√©, √©mergents en pleine ascension, pauvres stagnent"

**Onglet 3 (Donn√©es)** :
- Mentionner rapidement si question sur la m√©thodologie
- "√âchantillon robuste, 159 pays couvrant >95% du PIB mondial"
:::

---

## üìà R√©sultat n¬∞1 : Le mod√®le quadratique suffit

::: {.columns}
::: {.column width="55%"}
```{python}
#| echo: false
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import statsmodels.formula.api as smf

# Note : Le code suppose que df_cross est charg√© en m√©moire
# Estimation des mod√®les
m_quad = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2)', data=df_cross).fit(cov_type='HC3')
m_cub = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2) + I(log_gdp_c**3)', data=df_cross).fit(cov_type='HC3')

# Grille de pr√©diction
log_gdp_c_grid = np.linspace(df_cross['log_gdp_c'].min(), df_cross['log_gdp_c'].max(), 200)
pred_df = pd.DataFrame({'log_gdp_c': log_gdp_c_grid})

pred_quad = m_quad.predict(pred_df)
pred_cub = m_cub.predict(pred_df)

# Graphique
fig, ax = plt.subplots(figsize=(10, 7))

ax.scatter(df_cross['log_gdp_c'], df_cross['log_co2'], 
           alpha=0.3, color='gray', s=30, label='Observations (N=159)', zorder=1)

ax.plot(log_gdp_c_grid, pred_quad, 
        color='#c0392b', linewidth=2.5, label='Quadratique (retenu)', zorder=3)

ax.plot(log_gdp_c_grid, pred_cub, 
        color='#27ae60', linewidth=2, linestyle='--', label='Cubique (rejet√©)', zorder=2)

ax.set_xlabel("$\\ln(\\mathrm{PIB})$ centr√©", fontsize=11)
ax.set_ylabel("$\\ln(\\mathrm{CO}_2)$", fontsize=11)
ax.legend(loc='upper left', fontsize=10)
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
```
:::

::: {.column width="45%"}
**R√©sultats d'estimation**

| Coefficient | Quadratique | Cubique |
|-------------|-------------|---------|
| $\beta_1$ | 1.070*** | 1.070*** |
| $\beta_2$ | **-0.083***| -0.083** |
| $\beta_3$ | ‚Äî | -0.0002 |
| | | (p=0.995) |

**Performance pr√©dictive (CV k=5)**

| Mod√®le | RMSE |
|--------|------|
| **Quadratique** | **0.568** ‚úÖ |
| Cubique | 0.580 ‚ùå |

::: {.fragment}
::: {.callout-tip}
## Verdict
‚úÖ EKC classique valid√©e ($\beta_2 < 0$)

‚ùå Courbe en N rejet√©e ($\beta_3 \approx 0$)
:::
:::
:::
:::

::: {.notes}
Les deux courbes se superposent presque parfaitement. Le cubique n'apporte rien visuellement ni statistiquement. Principe de parcimonie : on garde le quadratique.
:::

---

## üîç L'h√©t√©rog√©n√©it√© masqu√©e : Trois clubs de pays

::: {.columns}
::: {.column width="33%"}
::: {.callout-warning}
## üî¥ Sur-carbon√©s
**Au-dessus de l'EKC**

- üá∂üá¶ Qatar : 35 t
- üá∞üáº Kowe√Øt : 25 t
- üá¶üá∫ Australie : 17 t

*Rente fossile*
:::
:::

::: {.column width="33%"}
::: {.callout-note}
## üü° Sur la courbe
**Trajectoire moyenne**

- üá∫üá∏ USA : 14 t
- üá©üá™ Allemagne : 8 t
- üáØüáµ Japon : 9 t

*Transition en cours*
:::
:::

::: {.column width="33%"}
::: {.callout-tip}
## üü¢ D√©carbon√©s
**Sous l'EKC**

- üá∏üá™ Su√®de : 4 t
- üá´üá∑ France : 5 t
- üá®üá≠ Suisse : 4 t

*Nucl√©aire + hydro*
:::
:::
:::

::: {.fragment}
::: {.callout-important}
## Message cl√©
√Ä **PIB √©gal** (~50k $/hab) : üá∏üá™ Su√®de = **4 t** | üá∂üá¶ Qatar = **35 t** ‚Üí **Facteur 9**

‚Üí Les **choix politiques** comptent plus que la richesse seule
:::
:::
