# Approche Temporelle {background-color="#1976D2"}

::: {style="text-align: center; margin-top: 3em;"}
## ðŸŽ¬ Partie II : Validation temporelle

**USA (1990-2020)** | Le dÃ©couplage observÃ© est-il structurel ou conjoncturel ?
:::

::: {.notes}
**1. INTRODUCTION (40s)**

On passe de la photo (analyse transversale) au film : on suit les USA sur **30 ans (1990-2020)**. 

**Pourquoi eux ?**
â†’ Premier Ã©metteur historique, Ã©conomie mature, donnÃ©es fiables.
â†’ IdÃ©al pour tester si le dÃ©couplage PIB-COâ‚‚ est **structurel**â€¦ ou juste un coup de chance.
:::

---

## ðŸ‡ºðŸ‡¸ Le cas amÃ©ricain : SÃ©rie et modÃ¨le ARDL

::: {.columns}
::: {.column width="55%"}
```{python}
#| echo: false
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

# Note : suppose df_usa chargÃ©
fig, ax = plt.subplots(figsize=(10, 7))

ax.plot(df_usa['year'], df_usa['co2_per_capita'], 
        'o-', color='#2c3e50', linewidth=2.5, markersize=6, label='Ã‰missions observÃ©es')

# Identification du pic
idx_max = df_usa['co2_per_capita'].idxmax()
year_max = df_usa.loc[idx_max, 'year']
co2_max = df_usa.loc[idx_max, 'co2_per_capita']

ax.axvline(year_max, color='#c0392b', linestyle='--', linewidth=2, alpha=0.7, label=f'Pic ({int(year_max)})')
ax.plot(year_max, co2_max, 'r*', markersize=20, zorder=5)

ax.text(year_max + 1, co2_max, 
        f'{co2_max:.1f} t/hab', 
        fontsize=11, fontweight='bold', 
        bbox=dict(boxstyle='round,pad=0.5', facecolor='#f1c40f', alpha=0.8))

ax.set_xlabel("AnnÃ©e", fontsize=12)
ax.set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
ax.set_title("Ã‰volution des Ã©missions USA (1990-2020)", fontweight='bold', fontsize=13)
ax.legend(loc='upper right', fontsize=10)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```
:::

::: {.column width="45%"}
**ModÃ¨le ARDL(1,1)**

$$\ln(\mathrm{CO}_2)_t = \rho \ln(\mathrm{CO}_2)_{t-1} + \beta_0 \ln(\text{PIB})_t + \beta_1 \ln(\text{PIB})_{t-1} + \varepsilon_t$$

**RÃ©sultats clÃ©s**

| ParamÃ¨tre | Valeur | InterprÃ©tation |
|-----------|--------|----------------|
| $\rho$ | **1.003*** | Inertie extrÃªme |
| $\varepsilon_{CT}$ | -0.122* | Faible Ã©lasticitÃ© |
| Pic | **2000** | Turning point |
| Baisse | **-21%** | 2000â†’2020 |

::: {.fragment}
::: {.callout-warning}
## âš ï¸ Inertie structurelle
$\rho \approx 1$ â†’ Chocs **quasi-permanents**

Demi-vie : **Non calculable**
:::
:::
:::
:::

::: {.notes}
2. LE MODÃˆLE ARDL (50s)
Pas de simple rÃ©gression (OLS), car :

1. Les Ã©missions sont inertielles (ce quâ€™on construit aujourdâ€™hui dure 30-50 ans).
2. On veut sÃ©parer effet court terme vs long terme.
3. Nos sÃ©ries sont non-stationnaires (tests ADF confirmÃ©s).

ðŸ‘‰ Correction : erreurs Newey-West avec 3 lags (rÃ¨gle T^0.25).

3. RÃ‰SULTATS CHOC : Ï = 1,003 (50s)
Le cÅ“ur du modÃ¨le : Ï = 1,003 â†’ quasi 1.
â†’ Signifie que les chocs sont quasi-permanents.
â†’ Demi-vie non calculable.
â†’ En pratique : toute politique climatique doit durer plus de 30 ans.

- Ã‰lasticitÃ© court terme : -0,122 (TrÃ¨s faible).
- Pic en 2005, baisse de -21%.
- Pas de "rebond" (courbe en N rejetÃ©e).
:::


---

## ðŸ”® Projection 2025 et validation hors-Ã©chantillon

::: {.panel-tabset}

### Projection

```{python}
#| echo: false
#| code-fold: true
#| code-summary: "ðŸ“‚ Code de projection ARDL"
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

import statsmodels.formula.api as smf
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 1 : Estimation du modÃ¨le ARDL quadratique
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

m_ardl_quad = smf.ols(
    'log_co2 ~ lag_log_co2 + log_gdp_c + I(log_gdp_c**2)', 
    data=df_usa
).fit(cov_type='HAC', cov_kwds={'maxlags': 3})

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 2 : Projection itÃ©rative 2021-2025
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

last_obs = df_usa.iloc[-1]
future_years = list(range(ANNEE_FIN + 1, ANNEE_FIN + 6))  # 2021-2025

future_df = []
curr_log_co2 = last_obs['log_co2']
curr_log_gdp = last_obs['log_gdp']

TAUX_CROISSANCE_ANNUEL = 0.02  # HypothÃ¨se : +2% PIB/an

for year in future_years:
    # Mise Ã  jour du PIB
    curr_log_gdp += np.log(1 + TAUX_CROISSANCE_ANNUEL)
    curr_log_gdp_c = curr_log_gdp - GDP_MEAN_USA
    
    # Construction de la matrice de prÃ©diction
    X_fut = pd.DataFrame({
        'lag_log_co2': [curr_log_co2],
        'log_gdp_c': [curr_log_gdp_c],
        'I(log_gdp_c ** 2)': [curr_log_gdp_c ** 2]
    })
    
    # PrÃ©diction avec intervalle de confiance
    pred = m_ardl_quad.get_prediction(X_fut)
    pred_summary = pred.summary_frame(alpha=0.05)
    
    # Stockage des rÃ©sultats (en Ã©chelle originale)
    future_df.append({
        'year': year,
        'co2_pred': np.exp(pred_summary['mean'].values[0]),
        'co2_lower': np.exp(pred_summary['mean_ci_lower'].values[0]),
        'co2_upper': np.exp(pred_summary['mean_ci_upper'].values[0]),
    })
    
    # Mise Ã  jour pour l'itÃ©ration suivante
    curr_log_co2 = pred_summary['mean'].values[0]

df_future = pd.DataFrame(future_df)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 3 : Graphique projection
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

fig, ax = plt.subplots(figsize=(10, 7))

# Historique
ax.plot(df_usa['year'], df_usa['co2_per_capita'], 
        'ko-', linewidth=2, markersize=5, label='Historique', zorder=3)

# Projection
ax.plot(df_future['year'], df_future['co2_pred'], 
        'r--', linewidth=2.5, marker='s', markersize=7, 
        label='Projection (+2% PIB/an)', zorder=2)

# Intervalle de confiance 95%
ax.fill_between(df_future['year'], 
                df_future['co2_lower'], 
                df_future['co2_upper'],
                color='red', alpha=0.2, label='IC 95%', zorder=1)

# Ligne de sÃ©paration
ax.axvline(ANNEE_FIN, color='gray', linestyle=':', linewidth=2, zorder=0)

# Labels et mise en forme
ax.set_xlabel("AnnÃ©e", fontsize=12)
ax.set_ylabel("$\\mathrm{CO}_2$/hab (tonnes)", fontsize=12)
ax.set_title("Projection USA : ScÃ©nario tendanciel", fontweight='bold', fontsize=13)
ax.legend(loc='upper right', fontsize=10)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

::: {.callout-important}
## Ã‰cart avec l'Accord de Paris
| MÃ©trique | Projection 2025 | Objectif 2030 (Paris) |
|----------|-----------------|-----------------------|
| Variation vs 2020 | **-8.5%** | **-50%** requis |
| Niveau | 13.0 t/hab | 7.1 t/hab |

â†’ Gap de **29 points** : trajectoire insuffisante.
:::

### Validation

**Performance hors-Ã©chantillon (2016-2020)**

| ModÃ¨le | RMSE | vs ARDL |
|--------|------|---------|
| **ARDL Quadratique** | **0.047** | â€” |
| ARIMA(1,1,1) | 0.050 | +6% |
| Marche alÃ©atoire | 0.052 | +11% |

::: {.callout-tip}
## âœ… ARDL bat tous les benchmarks
Sur donnÃ©es **non vues** (2016-2020), l'ARDL offre l'erreur la plus faible.

â†’ La capacitÃ© prÃ©dictive du modÃ¨le est validÃ©e.
:::

:::

::: {.notes}
4. VALIDATION & PROJECTION (50s)

- Test hors-Ã©chantillon (2016-2020) : RMSE = 0,047 (Mieux que tous les benchmarks). ModÃ¨le ROBUSTE.
- Projection 2025 (+2% PIB/an) : Baisse de 8,5% seulement.
- Accord de Paris : -50% requis.

ðŸ”´ GAP DE 29 POINTS
â†’ Trajectoire 6 fois trop lente.
â†’ Intervalle de confiance sâ€™Ã©largit vite (incertitude due Ã  Ïâ‰ˆ1).

5. CONCLUSION FINALE (30s)

1. DÃ©couplage rÃ©el (Oui, pic 2005).
2. Mais lent et bloquÃ© (Inertie extrÃªme).
3. Insuffisant : MarchÃ© seul Ã©chec. Besoin rupture politique.

ðŸ“Œ En gros :
â†’ Dans lâ€™espace (SuÃ¨de), c'est possible (4 t/hab).
â†’ Dans le temps (USA), c'est trop lent (13 t/hab en 2025 vs 7 t/hab requis).

âš¡ REPONSES AUX QUESTIONS  
ðŸ”¹ â€œPourquoi ARDL et pas OLS ?â€ -> SÃ©ries I(1).  
ðŸ”¹ â€œPourquoi 3 lags Newey-West ?â€ -> RÃ¨gle T^0.25.  
ðŸ”¹ â€œÏ=1,003 ?â€ -> Biais petit Ã©chantillon possible, mais reflÃ¨te l'inertie physique.  
ðŸ”¹ â€œPourquoi pas projeter 2030 ?â€ -> Variance explose.
:::
