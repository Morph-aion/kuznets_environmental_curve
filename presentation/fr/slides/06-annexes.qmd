# Annexes {background-color="#7F8C8D"}

---

## üìä A1. Statistiques descriptives

::: {style="font-size: 0.8em;"}
| Variable | Moyenne | √âcart-type | Min | Q1 | M√©diane | Q3 | Max |
|----------|---------|------------|-----|-----|---------|-----|-----|
| CO‚ÇÇ/hab (t) | 4.95 | 5.12 | 0.03 | 1.21 | 3.08 | 6.89 | 37.29 |
| PIB/hab (\$) | 18,473 | 20,115 | 661 | 3,892 | 11,045 | 26,384 | 116,935 |
| ln(CO‚ÇÇ) | 1.18 | 1.23 | -3.51 | 0.19 | 1.13 | 1.93 | 3.62 |
| ln(PIB) | 9.41 | 1.35 | 6.49 | 8.27 | 9.31 | 10.18 | 11.67 |
:::

**√âchantillon** : 159 pays, ann√©e 2020

---

## üßÆ A2. Formules des estimateurs

::: {.panel-tabset}

### OLS

**Estimateur**

$$\hat{\beta} = (X'X)^{-1}X'Y$$

**Variance HC3**

$$\widehat{\text{Var}}_{HC3}(\hat{\beta}) = (X'X)^{-1} \left(\sum_{i=1}^n \frac{\hat{\varepsilon}_i^2}{(1-h_{ii})^2} x_i x_i'\right) (X'X)^{-1}$$

o√π $h_{ii}$ = levier de l'observation $i$

### Newey-West

**Variance HAC**

$$\widehat{\text{Var}}_{NW}(\hat{\beta}) = (X'X)^{-1} \hat{\Omega} (X'X)^{-1}$$

avec

$$\hat{\Omega} = \hat{\Gamma}_0 + \sum_{j=1}^L \left(1 - \frac{j}{L+1}\right) (\hat{\Gamma}_j + \hat{\Gamma}_j')$$

**Choix de L** : $L \approx \lfloor 4(T/100)^{2/9} \rfloor$ ‚Üí L=3 pour T=30

### ARDL

**Sp√©cification ARDL(1,1)**

$$Y_t = \rho Y_{t-1} + \beta_0 X_t + \beta_1 X_{t-1} + \varepsilon_t$$

**Param√®tres structurels**

- √âlasticit√© CT : $\varepsilon_{CT} = \beta_0$
- √âlasticit√© LT : $\varepsilon_{LT} = \frac{\beta_0 + \beta_1}{1 - \rho}$ (si $|\rho| < 1$)
- Demi-vie : $H = \frac{\ln(0.5)}{\ln(\rho)}$

:::

---

## üìâ A3. Tests de sp√©cification

::: {.panel-tabset}

### Test ADF

**R√©gression auxiliaire**

$$\Delta y_t = \alpha + \beta t + \gamma y_{t-1} + \sum_{i=1}^p \delta_i \Delta y_{t-i} + \varepsilon_t$$

**Hypoth√®ses**

- $H_0$ : $\gamma = 0$ (racine unitaire ‚Üí non-stationnaire)
- $H_1$ : $\gamma < 0$ (stationnaire)

**R√®gle** : Si stat. t < valeur critique (ou p < 0.05) ‚Üí rejeter $H_0$

### Test F embo√Æt√©

**Statistique**

$$F = \frac{(SSR_r - SSR_u)/q}{SSR_u/(n-k-1)} \sim F(q, n-k-1)$$

o√π :
- $SSR_r$ = somme carr√©s r√©sidus (mod√®le contraint)
- $SSR_u$ = somme carr√©s r√©sidus (mod√®le non-contraint)
- $q$ = nombre de contraintes

### AIC

**Formule**

$$AIC = 2k - 2\ln(\hat{L})$$

o√π :
- $k$ = nombre de param√®tres
- $\hat{L}$ = vraisemblance maximale

**Interpr√©tation** : Plus bas = meilleur (p√©nalise la complexit√©)

:::

---

## üî¨ A4. Validation Box-Cox

**Principe** : D√©terminer la transformation optimale de $Y$

$$Y^{(\lambda)} = \begin{cases}
\frac{Y^\lambda - 1}{\lambda} & \text{si } \lambda \neq 0 \\
\ln(Y) & \text{si } \lambda = 0
\end{cases}$$

**R√©sultats**

| Param√®tre | Valeur |
|-----------|--------|
| $\lambda$ optimal | 0.15 |
| Distance √† log ($\lambda=0$) | 0.15 |
| Distance √† lin√©aire ($\lambda=1$) | 0.85 |

**Conclusion** : Transformation **logarithmique** fortement justifi√©e

---

## üìê A5. Validation non-param√©trique (LOWESS)

```{python}
#| echo: true
#| code-fold: true
#| code-summary: "üìÇ Voir le code de validation"

from statsmodels.nonparametric.smoothers_lowess import lowess
import matplotlib.pyplot as plt
import numpy as np

# Mod√®les param√©triques (si pas d√©j√† estim√©s)
if 'm_quad' not in locals():
    m_quad = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2)', data=df_cross).fit(cov_type='HC3')
    m_cub = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2) + I(log_gdp_c**3)', data=df_cross).fit(cov_type='HC3')

# LOWESS (non-param√©trique)
lowess_result = lowess(df_cross['log_co2'], df_cross['log_gdp_c'], frac=0.3)
```

```{python}
#| echo: false
#| fig-width: 11
#| fig-height: 5

fig, axes = plt.subplots(1, 2, figsize=(11, 5))

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# GAUCHE : LOG-LOG (espace de travail du mod√®le)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

axes[0].scatter(df_cross['log_gdp_c'], df_cross['log_co2'], 
                alpha=0.3, s=30, color='gray', label='Observations')

# Grille de pr√©diction
log_gdp_grid = np.linspace(df_cross['log_gdp_c'].min(), df_cross['log_gdp_c'].max(), 200)
pred_df = pd.DataFrame({'log_gdp_c': log_gdp_grid})

# Courbes param√©triques
pred_quad = m_quad.predict(pred_df)
pred_cub = m_cub.predict(pred_df)

axes[0].plot(log_gdp_grid, pred_quad, 
             color='#2ecc71', linewidth=2.5, label='Quadratique', linestyle='--')
axes[0].plot(log_gdp_grid, pred_cub, 
             color='#e74c3c', linewidth=2.5, label='Cubique', linestyle='-')

# LOWESS
axes[0].plot(lowess_result[:, 0], lowess_result[:, 1], 
             'b:', linewidth=3, label='LOWESS (non-param√©trique)')

axes[0].set_xlabel("$\\ln(\\mathrm{PIB})$ centr√©", fontsize=11)
axes[0].set_ylabel("$\\ln(\\mathrm{CO}_2)$", fontsize=11)
axes[0].set_title("A. √âchelle Log-Log\n(Espace de mod√©lisation)", fontweight='bold', fontsize=12)
axes[0].legend(loc='upper left', fontsize=10)
axes[0].grid(True, alpha=0.3)

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# DROITE : √âCHELLE ORIGINALE (tonnes r√©elles)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# Reconversion en √©chelle originale
gdp_grid_original = np.exp(log_gdp_grid + GDP_MEAN)

axes[1].scatter(df_cross['gdp_pc'], df_cross['co2_per_capita'], 
                alpha=0.3, s=30, color='gray')

axes[1].plot(gdp_grid_original, np.exp(pred_quad), 
             color='#2ecc71', linewidth=2.5, label='Quadratique', linestyle='--')
axes[1].plot(gdp_grid_original, np.exp(pred_cub), 
             color='#e74c3c', linewidth=2.5, label='Cubique', linestyle='-')

# LOWESS en √©chelle originale
lowess_gdp_original = np.exp(lowess_result[:, 0] + GDP_MEAN)
axes[1].plot(lowess_gdp_original, np.exp(lowess_result[:, 1]), 
             'b:', linewidth=3, label='LOWESS')

axes[1].set_xscale('log')
axes[1].set_xlabel("PIB par habitant (USD PPA 2017)", fontsize=11)
axes[1].set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=11)
axes[1].set_title("B. √âchelle Originale\n(R√©alit√© physique)", fontweight='bold', fontsize=12)
axes[1].legend(loc='upper left', fontsize=10)
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

::: {.callout-tip}
## R√©sultat de la validation

**Objectif** : V√©rifier que la forme quadratique n'est pas trop restrictive

**M√©thode** : LOWESS (Locally Weighted Scatterplot Smoothing) ‚Äî r√©gression non-param√©trique qui laisse les donn√©es "parler d'elles-m√™mes"

**R√©sultat** : 
- ‚úÖ Le mod√®le **quadratique suit bien** la tendance LOWESS
- ‚úÖ Le mod√®le **cubique** n'apporte rien (superposition quasi-parfaite)
- ‚ö†Ô∏è Aux tr√®s hauts revenus (>80k $/hab), l√©g√®re divergence ‚Üí h√©t√©rog√©n√©it√© masqu√©e

**Conclusion** : La sp√©cification quadratique est **robuste et parcimonieuse**
:::

---

## üìö R√©f√©rences cl√©s

::: {style="font-size: 0.75em;"}
**Fondations th√©oriques**
- Grossman, G. M., & Krueger, A. B. (1995). *Economic Growth and the Environment*. QJE.
- Stern, D. I. (2004). *The Rise and Fall of the Environmental Kuznets Curve*. World Development.

**Critiques m√©thodologiques**
- Wagner, M. (2008). *The Carbon Kuznets Curve: A Cloudy Picture Emitted by Bad Econometrics?*. Resource and Energy Economics.
- Peters, G. P., et al. (2011). *Growth in emission transfers via international trade*. PNAS.

**Extensions r√©centes**
- Allard, A., et al. (2018). *The N-shaped environmental Kuznets curve*. Economics Letters.

**M√©thodes √©conom√©triques**
- Pesaran, M. H., et al. (2001). *Bounds testing approaches to the analysis of level relationships*. Journal of Applied Econometrics.
- Newey, W. K., & West, K. D. (1987). *A Simple, Positive Semi-Definite, Heteroskedasticity and Autocorrelation Consistent Covariance Matrix*. Econometrica.
:::
