# Cross-Sectional Approach {background-color="#00796B"}

::: {style="text-align: center; margin-top: 3em;"}
## üì∏ Part I: Spatial Validation

**159 Countries (2020)** | What shape does the EKC take across space?
:::

::: {.notes}
Duration: ~7 minutes.
Objective: Show that the quadratic model is sufficient + highlight massive heterogeneity.
:::

---

## üåç Data and Empirical Context

::: {.panel-tabset}

### 2020 Overview

```{python}
#| echo: false
#| fig-width: 14
#| fig-height: 6
#| fig-dpi: 300

import matplotlib.pyplot as plt
import numpy as np
from statsmodels.nonparametric.smoothers_lowess import lowess

# S√©lection de pays √† annoter
PAYS_LABELS = {
    'United States': 'USA', 'China': 'CHN', 'India': 'IND', 
    'Qatar': 'QAT', 'France': 'FRA', 'Sweden': 'SWE', 
    'Germany': 'DEU', 'Brazil': 'BRA'
}

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# A. GRAPHIQUE LOG-LOG (Vision √©conom√©trique)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

axes[0].scatter(df_cross['gdp_pc'], df_cross['co2_per_capita'], 
                alpha=0.5, s=60, color='#34495e', edgecolor='white', linewidth=0.5)

axes[0].set_xscale('log')
axes[0].set_yscale('log')
axes[0].set_xlabel("PIB par habitant (USD PPA 2017)", fontsize=12)
axes[0].set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
axes[0].set_title("A. √âchelle Log-Log (Vision √âconom√©trique)", fontweight='bold', fontsize=13)
axes[0].grid(True, which="both", ls="--", alpha=0.3)

# Annotations
for pays, code in PAYS_LABELS.items():
    row = df_cross[df_cross['country'] == pays]
    if not row.empty:
        x = row['gdp_pc'].values[0]
        y = row['co2_per_capita'].values[0]
        axes[0].text(x, y, f" {code}", fontsize=9, fontweight='bold', 
                     color='#2c3e50', va='bottom')

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# B. GRAPHIQUE LOG-LIN (R√©alit√© physique)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

axes[1].scatter(df_cross['gdp_pc'], df_cross['co2_per_capita'], 
                alpha=0.5, s=60, color='#c0392b', edgecolor='white', linewidth=0.5)

# Tendance LOWESS
lowess_result = lowess(df_cross['co2_per_capita'], np.log(df_cross['gdp_pc']), frac=0.3)
axes[1].plot(np.exp(lowess_result[:, 0]), lowess_result[:, 1], 
             color='black', linewidth=2.5, linestyle='--', label='Tendance LOWESS')

axes[1].set_xscale('log')
axes[1].set_xlabel("PIB par habitant (USD PPA 2017)", fontsize=12)
axes[1].set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
axes[1].set_title("B. √âchelle Log-Lin√©aire (R√©alit√© Physique)", fontweight='bold', fontsize=13)
axes[1].legend(loc='upper left', fontsize=10)
axes[1].grid(True, which="both", ls="--", alpha=0.3)

# Annotations
for pays, code in PAYS_LABELS.items():
    row = df_cross[df_cross['country'] == pays]
    if not row.empty:
        x = row['gdp_pc'].values[0]
        y = row['co2_per_capita'].values[0]
        ha = 'right' if y > 30 else 'left'
        axes[1].text(x, y, f"{code} " if ha == 'right' else f" {code}", 
                     fontsize=9, fontweight='bold', 
                     color='#c0392b', va='center', ha=ha)

plt.tight_layout()
plt.show()
```

::: {.columns}
::: {.column width="50%"}
::: {.callout-note appearance="minimal"}
## Panel A: Log-Log Justification
Quasi-**linear** relationship in log scale  
‚Üí Interpretation in **elasticities**
:::
:::

::: {.column width="50%"}
::: {.callout-warning appearance="minimal"}
## Panel B: Heterogeneity
Qatar (35 t) vs Sweden (4 t) at equal GDP  
‚Üí **Factor of 9**: policies matter
:::
:::
:::

### Trajectories 1990-2020

```{python}
#| echo: false
#| fig-width: 12
#| fig-height: 6
#| fig-dpi: 300

import matplotlib.pyplot as plt

# Calcul des moyennes par groupe et ann√©e
trajectories = df.groupby(['year', 'income_group'])['co2_per_capita'].mean().reset_index()

# Palette de couleurs
palette = {
    'High income': '#e74c3c',
    'Upper middle income': '#f39c12', 
    'Lower middle income': '#3498db',
    'Low income': '#2ecc71'
}

# Graphique
fig, ax = plt.subplots(figsize=(12, 6))

for group, color in palette.items():
    subset = trajectories[trajectories['income_group'] == group]
    ax.plot(subset['year'], subset['co2_per_capita'], 
            color=color, linewidth=3, label=group, marker='o', markersize=5)

ax.set_xlabel("Ann√©e", fontsize=14)
ax.set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=14)
ax.set_title("√âvolution des √©missions par groupe de revenu (1990-2020)", fontweight='bold', fontsize=15)
ax.legend(loc='upper left', fontsize=12)
ax.grid(True, alpha=0.3)
ax.axhline(y=0, color='black', linewidth=0.8, linestyle='-')

plt.tight_layout()
plt.show()
```

::: {.callout-note appearance="minimal"}
## Three Divergent Clubs
üî¥ **Rich Countries**: Peak ~2005, decline -30%  
üü† **Emerging Economies**: Exponential growth +150%  
üîµ **Poor Countries**: Stagnation ~1 t/capita

‚Üí The EKC does **not** describe a universal law
:::

### Data Mobilized

::: {.columns}
::: {.column width="50%"}
**Source**

- Our World in Data (2020)
- Global Carbon Project
- World Bank

**Sample**

- **159 countries** (>95% of world GDP)
- Period: **1990-2020** (30 years)
- ~4770 observations
:::

::: {.column width="50%"}
**Key Variables**

| Variable | Unit | Transformation |
|----------|------|----------------|
| $\mathrm{CO}_2/\text{cap}$ | tonnes/year | $\mathrm{CO}_2$ |
| GDP/cap | 2017 PPP $ | $\ln(\text{GDP})$ centered |

**Exclusions**: 12 micro-states and tax havens  
(Liechtenstein, Monaco, Luxembourg, Singapore...)

**Log Justification**: Box-Cox Test ‚Üí Œª = 0.15 ‚âà 0
:::
:::

:::

::: {.notes}
**Oral Notes**:

**Tab 1 (Overview)**:
- Panel A: "In log-log, the relationship becomes quasi-linear ‚Üí justifies our specification"
- Panel B: "In real scale, we see explosive heterogeneity: Qatar vs Sweden = factor of 9"

**Tab 2 (Trajectories)**:
- "This heterogeneity is not static: 3 clubs have evolved differently over 30 years"
- "Rich countries have ALREADY decoupled, emerging ones are skyrocketing, poor ones stagnate"

**Tab 3 (Data)**:
- Mention quickly if asked about methodology
- "Robust sample, 159 countries covering >95% of world GDP"
:::

---

## üìà Result #1: The Quadratic Model is Sufficient

::: {.columns}
::: {.column width="55%"}
```{python}
#| echo: false
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import statsmodels.formula.api as smf

# Note : Le code suppose que df_cross est charg√© en m√©moire
# Estimation des mod√®les
m_quad = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2)', data=df_cross).fit(cov_type='HC3')
m_cub = smf.ols('log_co2 ~ log_gdp_c + I(log_gdp_c**2) + I(log_gdp_c**3)', data=df_cross).fit(cov_type='HC3')

# Grille de pr√©diction
log_gdp_c_grid = np.linspace(df_cross['log_gdp_c'].min(), df_cross['log_gdp_c'].max(), 200)
pred_df = pd.DataFrame({'log_gdp_c': log_gdp_c_grid})

pred_quad = m_quad.predict(pred_df)
pred_cub = m_cub.predict(pred_df)

# Graphique
fig, ax = plt.subplots(figsize=(10, 7))

ax.scatter(df_cross['log_gdp_c'], df_cross['log_co2'], 
           alpha=0.3, color='gray', s=30, label='Observations (N=159)', zorder=1)

ax.plot(log_gdp_c_grid, pred_quad, 
        color='#c0392b', linewidth=2.5, label='Quadratique (retenu)', zorder=3)

ax.plot(log_gdp_c_grid, pred_cub, 
        color='#27ae60', linewidth=2, linestyle='--', label='Cubique (rejet√©)', zorder=2)

ax.set_xlabel("$\\ln(\\mathrm{PIB})$ centr√©", fontsize=11)
ax.set_ylabel("$\\ln(\\mathrm{CO}_2)$", fontsize=11)
ax.legend(loc='upper left', fontsize=10)
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
```
:::

::: {.column width="45%"}
**Estimation Results**

| Coefficient | Quadratic | Cubic |
|-------------|-----------|-------|
| $\beta_1$ | 1.070*** | 1.070*** |
| $\beta_2$ | **-0.083***| -0.083** |
| $\beta_3$ | ‚Äî | -0.0002 |
| | | (p=0.995) |

**Predictive Performance (CV k=5)**

| Model | RMSE |
|-------|------|
| **Quadratic** | **0.568** ‚úÖ |
| Cubic | 0.580 ‚ùå |

::: {.fragment}
::: {.callout-tip}
## Verdict
‚úÖ Classic EKC validated ($\beta_2 < 0$)

‚ùå N-shaped curve rejected ($\beta_3 \approx 0$)
:::
:::
:::
:::

::: {.notes}
The two curves overlap almost perfectly. The cubic term adds nothing visually or statistically. Principle of Parsimony: we keep the quadratic.
:::

---

## üîç Hidden Heterogeneity: Three Country Clubs

::: {.columns}
::: {.column width="33%"}
::: {.callout-warning}
## üî¥ Carbon-Intensive
**Above the EKC**

- üá∂üá¶ Qatar: 35 t
- üá∞üáº Kuwait: 25 t
- üá¶üá∫ Australia: 17 t

*Fossil Rent*
:::
:::

::: {.column width="33%"}
::: {.callout-note}
## üü° On the Curve
**Average Trajectory**

- üá∫üá∏ USA: 14 t
- üá©üá™ Germany: 8 t
- üáØüáµ Japan: 9 t

*Transition underway*
:::
:::

::: {.column width="33%"}
::: {.callout-tip}
## üü¢ Decarbonized
**Below the EKC**

- üá∏üá™ Sweden: 4 t
- üá´üá∑ France: 5 t
- üá®üá≠ Switzerland: 4 t

*Nuclear + Hydro*
:::
:::
:::

::: {.fragment}
::: {.callout-important}
## Key Message
At **equal GDP** (~50k $/capita): üá∏üá™ Sweden = **4 t** | üá∂üá¶ Qatar = **35 t** ‚Üí **Factor of 9**

‚Üí **Political choices** matter more than wealth alone.
:::
:::
