# Time-Series Approach {background-color="#1976D2"}

::: {style="text-align: center; margin-top: 3em;"}
## ğŸ¬ Part II: Temporal Validation

**USA (1990-2020)** | Is the observed decoupling structural or cyclical?
:::

::: {.notes}
Duration: ~7 minutes.
Objective: Show extreme inertia + insufficient projection for Paris Agreement.
:::

---

## ğŸ‡ºğŸ‡¸ The American Case: Series and ARDL Model

::: {.columns}
::: {.column width="55%"}
```{python}
#| echo: false
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

# Note : suppose df_usa chargÃ©
fig, ax = plt.subplots(figsize=(10, 7))

ax.plot(df_usa['year'], df_usa['co2_per_capita'], 
        'o-', color='#2c3e50', linewidth=2.5, markersize=6, label='Ã‰missions observÃ©es')

# Identification du pic
idx_max = df_usa['co2_per_capita'].idxmax()
year_max = df_usa.loc[idx_max, 'year']
co2_max = df_usa.loc[idx_max, 'co2_per_capita']

ax.axvline(year_max, color='#c0392b', linestyle='--', linewidth=2, alpha=0.7, label=f'Pic ({int(year_max)})')
ax.plot(year_max, co2_max, 'r*', markersize=20, zorder=5)

ax.text(year_max + 1, co2_max, 
        f'{co2_max:.1f} t/hab', 
        fontsize=11, fontweight='bold', 
        bbox=dict(boxstyle='round,pad=0.5', facecolor='#f1c40f', alpha=0.8))

ax.set_xlabel("AnnÃ©e", fontsize=12)
ax.set_ylabel("$\\mathrm{CO}_2$ par habitant (tonnes)", fontsize=12)
ax.set_title("Ã‰volution des Ã©missions USA (1990-2020)", fontweight='bold', fontsize=13)
ax.legend(loc='upper right', fontsize=10)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```
:::

::: {.column width="45%"}
**ARDL(1,1) Model**

$$\ln(\mathrm{CO}_2)_t = \rho \ln(\mathrm{CO}_2)_{t-1} + \beta_0 \ln(\text{GDP})_t + \beta_1 \ln(\text{GDP})_{t-1} + \varepsilon_t$$

**Key Results**

| Parameter | Value | Interpretation |
|-----------|-------|----------------|
| $\rho$ | **1.003*** | Extreme Inertia |
| $\varepsilon_{CT}$ | -0.122* | Low Elasticity |
| Peak | **2005** | Turning point |
| Decline | **-21%** | 2005â†’2020 |

::: {.fragment}
::: {.callout-warning}
## âš ï¸ Structural Inertia
$\rho \approx 1$ â†’ **Quasi-permanent** shocks

Half-life: **Non-calculable**
:::
:::
:::
:::

---

## ğŸ”® 2025 Projection and Out-of-Sample Validation

::: {.panel-tabset}

### Projection

```{python}
#| echo: false
#| code-fold: true
#| code-summary: "ğŸ“‚ Code de projection ARDL"
#| fig-width: 10
#| fig-height: 7
#| fig-dpi: 300

import statsmodels.formula.api as smf
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 1 : Estimation du modÃ¨le ARDL quadratique
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

m_ardl_quad = smf.ols(
    'log_co2 ~ lag_log_co2 + log_gdp_c + I(log_gdp_c**2)', 
    data=df_usa
).fit(cov_type='HAC', cov_kwds={'maxlags': 3})

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 2 : Projection itÃ©rative 2021-2025
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

last_obs = df_usa.iloc[-1]
future_years = list(range(ANNEE_FIN + 1, ANNEE_FIN + 6))  # 2021-2025

future_df = []
curr_log_co2 = last_obs['log_co2']
curr_log_gdp = last_obs['log_gdp']

TAUX_CROISSANCE_ANNUEL = 0.02  # HypothÃ¨se : +2% PIB/an

for year in future_years:
    # Mise Ã  jour du PIB
    curr_log_gdp += np.log(1 + TAUX_CROISSANCE_ANNUEL)
    curr_log_gdp_c = curr_log_gdp - GDP_MEAN_USA
    
    # Construction de la matrice de prÃ©diction
    X_fut = pd.DataFrame({
        'lag_log_co2': [curr_log_co2],
        'log_gdp_c': [curr_log_gdp_c],
        'I(log_gdp_c ** 2)': [curr_log_gdp_c ** 2]
    })
    
    # PrÃ©diction avec intervalle de confiance
    pred = m_ardl_quad.get_prediction(X_fut)
    pred_summary = pred.summary_frame(alpha=0.05)
    
    # Stockage des rÃ©sultats (en Ã©chelle originale)
    future_df.append({
        'year': year,
        'co2_pred': np.exp(pred_summary['mean'].values[0]),
        'co2_lower': np.exp(pred_summary['mean_ci_lower'].values[0]),
        'co2_upper': np.exp(pred_summary['mean_ci_upper'].values[0]),
    })
    
    # Mise Ã  jour pour l'itÃ©ration suivante
    curr_log_co2 = pred_summary['mean'].values[0]

df_future = pd.DataFrame(future_df)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ã‰TAPE 3 : Graphique projection
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

fig, ax = plt.subplots(figsize=(10, 7))

# Historique
ax.plot(df_usa['year'], df_usa['co2_per_capita'], 
        'ko-', linewidth=2, markersize=5, label='Historique', zorder=3)

# Projection
ax.plot(df_future['year'], df_future['co2_pred'], 
        'r--', linewidth=2.5, marker='s', markersize=7, 
        label='Projection (+2% PIB/an)', zorder=2)

# Intervalle de confiance 95%
ax.fill_between(df_future['year'], 
                df_future['co2_lower'], 
                df_future['co2_upper'],
                color='red', alpha=0.2, label='IC 95%', zorder=1)

# Ligne de sÃ©paration
ax.axvline(ANNEE_FIN, color='gray', linestyle=':', linewidth=2, zorder=0)

# Labels et mise en forme
ax.set_xlabel("AnnÃ©e", fontsize=12)
ax.set_ylabel("$\\mathrm{CO}_2$/hab (tonnes)", fontsize=12)
ax.set_title("Projection USA : ScÃ©nario tendanciel", fontweight='bold', fontsize=13)
ax.legend(loc='upper right', fontsize=10)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

::: {.callout-important}
## Gap with the Paris Agreement
| Metric | 2025 Projection | 2030 Target (Paris) |
|--------|-----------------|---------------------|
| Change vs 2020 | **-8.5%** | **-50%** required |
| Level | 13.0 t/capita | 7.1 t/capita |

â†’ **29-point** gap: insufficient trajectory.
:::

### Validation

**Out-of-Sample Performance (2016-2020)**

| Model | RMSE | vs ARDL |
|-------|------|---------|
| **Quadratic ARDL** | **0.047** | â€” |
| ARIMA(1,1,1) | 0.050 | +6% |
| Random Walk | 0.052 | +11% |

::: {.callout-tip}
## âœ… ARDL beats all benchmarks
On **unseen data** (2016-2020), ARDL offers the lowest error.

â†’ The model's predictive capacity is validated.
:::

:::
